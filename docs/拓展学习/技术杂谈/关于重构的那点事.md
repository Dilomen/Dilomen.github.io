## 前言

最近在看一本叫《重构 改善既有代码的设计》这本书，虽然很多是思想，但是都值得让程序员去思考重构这件事，这里也当算是做个笔记。  
在我们编写程序中，往往随着时间的推移，一个好的程序设计会变得臃肿或者不符合当下需求，又或是曾经为了赶进度，代码设计有问题，这时候我们都需要通过重构来改善我们的代码————以便后期的维护和开发。

> 重构的唯一目的是让我们开发更快，它有时候会是一种短期内的成本损耗，但它在长期看来必定是收益颇丰的工作。是否重构应该是从价值判断的取舍，在合适的时候去进行适当规模的重构，能避免带来一定的损失，当然前提是你的老板本身是支持员工改善代码这件事，否则这种又累又不讨好的活可不是谁都爱干的哦 🐶

:::tip
重构应该是由经济利益驱动，当然它不会立即从经济收益中体现，毕竟他是服务开发的，它的价值在于提升开发效益，从而加快开发进度，由此实现的间接收益
:::

所以在落实重构这件事情上，不同的技术部门应该考虑当下的现状，比如本身员工是否主动愿意去做重构这件事，有比如当下是否对重构代码有测试进行同步支持，如果有，那么是以一种什么形式开展，如果没有，那么风险点是由谁来承担，即要有赏罚分明的制度等等，再者还需要权衡利弊，判断重构对当下的收益是否可观，或者说是否值得去做（这个往往是一些大的重构，如修改技术方案，技术架构调整等）。

#### 那么在来来说说重构的好处

重构可以小到修改命名，大到整个模块（重构和重写是不一样的！）

- 更加规范的命名可以让我们更加直观的明白其的作用或者含义
- 代码解耦，函数分解能让我们更加快速的找到对应的地方，并处理问题
- 设计更合理的方案，能满足更好的需求变更
- 性能优化和代码书写优化，也是重构的范畴
- 有利于后期维护工作和新需求的功能添加，对后面加入的开发者也会比较友好
- ...

## 第一章.示例

该书第一章是以一个函数作为示例，一步一步的将其重构，从而带领读者认知重构的魅力。

从提炼函数、改变传参、抽离变量、分离文件、多态优化等一系列手法将原本一个臃肿的函数“四分五裂”地改成了一堆功能明确的函数。

## 第二章.原则

该章主要讲了重构的意义。

> 重构（名词）：对软件内部结构的一种调整，目的是<em>在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本</em>  
> 重构（动词）：使用一系列重构手法，<em>在不改变软件可观察行为的前提下，调整其结构</em>

#### 为何重构（好处）

- 改进设计：代码结构的设计，方案的设计，架构的设计等等，有助于整个软件（项目）的可持续发展
- 可读性：让代码更易于理解，方便修改
- 定位问题：重构可以让原本杂乱的结构变的条理有序，可以更好的将问题定位到某一块区域的代码
- 提升效率：对一些计算可进行优化，从而提升代码执行效率

#### 何时重构

- 预备性重构：在添加新功能前，发现原有功能设计不友好或者说满足不了之后的需求
- 帮助理解的重构：当看到既有代码，却难以理解其作用或意义的时候
- 有计划的重构：这个往往出现在对大的现有方案或设计进行重构，对当下的设计有很大程度的调整，也需要很大的成本时才会采取
- 长期重构：逐步的解决
- 复审代码：通过大家一起对代码审查，修改不合理的设计

#### 重构的条件

- 是否不影响新功能开发的进度
- 每个人是否都有对代码修改的权利
- 如何集成重构后的分支
- 是否有完善的测试机制支持

## 第三章.坏味道

该章主要是叙述了一些代码场景，当遇到这些情况，就可以去考虑是否需要去重构代码了（当然这个不是百分百，具体还是需要考虑实际情况）

| 名称     | 解释                                                                               |
| -------- | ---------------------------------------------------------------------------------- |
| 神秘命名  | 不明确的命名，我们应该需要结合当下的业务场景，或者方法功能，编写一个直观明确的名称 |
| 重复代码  | 重复的代码需要提炼出来，使其可以共用                                               |

### 待续ing
