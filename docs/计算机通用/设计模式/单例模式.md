---
title: 单例模式
tags: 设计模式
categories: 设计模式
keywords: 工厂模式,js,设计模式
description: 设计模式
date: 2020-02-16 10:52:34
---

## 简介

:::tip
只允许被实例化一次的类。
:::

#### 由面向对象的规则可知，类可以实例化不同的对象，各个对象相互都是独立的。但是有时候我们需要所有的操作都在一个对象上完成，即该对象可以作为一个命名空间，管理内部的属性和方法，那么最好的办法就是让类只能实例化一次，从而有效的避免多个对象引起的问题。

场景：往往使用在处理唯一事物，如登录弹框等，只会被创建一次

## 简单实现

1. 首先根据单例模式的定义，在 JavaScript 中完全可以使用一个全局对象实现，但是要避免这个对象被重写或覆盖

```js
var namespace = {
  get: function() {}
};
```

2. 利用闭包，将\_instance 变量保存了下来

```js
var Singleton = (function() {
  var _instance = null;
  function Person(name) {
    this.name = name;
  }
  return function(name) {
    if (!_instance) {
      _instance = new Person(name);
    }
    return _instance;
  };
})();
var a = Singleton("a");
var b = Singleton("b");
console.log(a);
console.log(b);
```

## 场景应用

创建一个唯一的 DOM 元素，以下使用的是**惰性单例**，即延迟创建或被使用时创建

```html
<button id="btn">点击创建元素</button>
```

```js
document.getElementById("btn").onclick = getSingle(CreateDiv);
function CreateDiv() {
  var oDiv = document.createElement("div");
  oDiv.innerText = "Hello World";
  document.body.appendChild(oDiv);
  return oDiv;
}

function getSingle(fn) {
  var result;
  return function() {
    result || (result = fn.apply(this, arguments));
  };
}
```
